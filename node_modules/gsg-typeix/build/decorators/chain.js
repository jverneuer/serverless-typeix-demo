"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("../core");
const metadata_1 = require("../injector/metadata");
/**
 * @since 1.0.0
 * @decorator
 * @function
 * @name Chain
 *
 * @description
 * Chain propagate data from FilterBefore -> BeforeEach -> Before -> Action -> After -> AfterEach -> FilterAfter
 *
 * @example
 * import {Chain, Param, Controller, Action, Inject} from "typeix";
 *
 * \@Controller({
 *    name: "myController"
 * })
 * class MyController{
 *
 *     \@Before("index")
 *     actionIndex() {
 *        return "My Index";
 *     }
 *
 *     \@Action("index")
 *     actionIndex(@Chain data, @Param("file") file: string) {
 *        return "My Index " + data;
 *     }
 * }
 */
exports.Chain = (Class, key, paramIndex) => {
    let type = "Chain";
    let metadata = [];
    if (metadata_1.Metadata.hasMetadata(Class, metadata_1.FUNCTION_PARAMS)) {
        metadata = metadata_1.Metadata.getMetadata(Class, metadata_1.FUNCTION_PARAMS);
    }
    if (!core_1.isNumber(paramIndex)) {
        throw new TypeError(`@${type} is not allowed ${metadata_1.Metadata.getName(Class, "on class ")} on ${paramIndex}
      @${type} is allowed only as parameter type!`);
    }
    metadata.push({
        type,
        key,
        value: null,
        paramIndex
    });
    metadata_1.Metadata.defineMetadata(Class, metadata_1.FUNCTION_PARAMS, metadata);
    return Class;
};
//# sourceMappingURL=chain.js.map